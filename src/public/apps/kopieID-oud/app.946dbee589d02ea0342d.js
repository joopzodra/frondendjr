webpackJsonp([0],{0:function(module,exports,__webpack_require__){"use strict";var platform_browser_dynamic_1=__webpack_require__(1),core_1=__webpack_require__(11),app_module_1=__webpack_require__(337);core_1.enableProdMode(),platform_browser_dynamic_1.platformBrowserDynamic().bootstrapModule(app_module_1.AppModule)},337:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),platform_browser_1=__webpack_require__(203),app_routing_1=__webpack_require__(338),app_component_1=__webpack_require__(412),upload_component_1=__webpack_require__(400),rotate_component_1=__webpack_require__(404),bitmapOnCanvas_component_1=__webpack_require__(413),pdfOnCanvas_component_1=__webpack_require__(414),draw_component_1=__webpack_require__(405),drawingOnCanvas_component_1=__webpack_require__(415),text_component_1=__webpack_require__(406),textOnCanvas_component_1=__webpack_require__(416),download_component_1=__webpack_require__(407),canvas_service_1=__webpack_require__(402),file_service_1=__webpack_require__(403);__webpack_require__(417);var AppModule=function(){function AppModule(){}return AppModule=__decorate([core_1.NgModule({declarations:[app_component_1.AppComponent,upload_component_1.UploadComponent,rotate_component_1.RotateComponent,bitmapOnCanvas_component_1.BitmapOnCanvas,pdfOnCanvas_component_1.PdfOnCanvas,draw_component_1.DrawComponent,drawingOnCanvas_component_1.DrawingOnCanvas,text_component_1.TextComponent,textOnCanvas_component_1.TextOnCanvas,download_component_1.DownloadComponent],imports:[platform_browser_1.BrowserModule,app_routing_1.routing],providers:[app_routing_1.appRoutingProviders,canvas_service_1.CanvasService,file_service_1.FileService],bootstrap:[app_component_1.AppComponent]}),__metadata("design:paramtypes",[])],AppModule)}();exports.AppModule=AppModule},338:function(module,exports,__webpack_require__){"use strict";var router_1=__webpack_require__(339),upload_component_1=__webpack_require__(400),rotate_component_1=__webpack_require__(404),draw_component_1=__webpack_require__(405),text_component_1=__webpack_require__(406),download_component_1=__webpack_require__(407),appRoutes=[{path:"upload",component:upload_component_1.UploadComponent},{path:"rotate",component:rotate_component_1.RotateComponent},{path:"draw",component:draw_component_1.DrawComponent},{path:"text",component:text_component_1.TextComponent},{path:"download",component:download_component_1.DownloadComponent},{path:"",redirectTo:"/upload",pathMatch:"full"},{path:"**",redirectTo:"/upload"}];exports.appRoutingProviders=[],exports.routing=router_1.RouterModule.forRoot(appRoutes)},400:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),PDFJS=__webpack_require__(401),canvas_service_1=__webpack_require__(402),file_service_1=__webpack_require__(403),UploadComponent=function(){function UploadComponent(fileService,canvasService){this.fileService=fileService,this.canvasService=canvasService}return UploadComponent.prototype.onChange=function(event){var _this=this,inputTarget=event.target||event.srcElement,newFile=inputTarget.files[0];if(newFile)return this.canvasService.clearDrawing(!0),this.canvasService.showDrawingCanvas(!1),this.canvasService.showTextCanvas(!1),this.canvasService.rotated=0,this.canvasService.textValue="",newFile.type.match("image.*")?this.loadImg(newFile).then(function(file){return _this.setDrawAndTextCanvasses(),file}):newFile.type.match("application/pdf")||newFile.type.match("application/force-download")?this.loadPdf(newFile).then(function(file){return _this.setDrawAndTextCanvasses(),file}):void alert("Je hebt geen afbeeldingsbestand of pdf gekozen. Kies opnieuw.")},UploadComponent.prototype.loadImg=function(newFile){var _this=this,reader=new FileReader,img=new Image;return reader.readAsDataURL(newFile),new Promise(function(resolve,reject){reader.onload=resolve,reader.onerror=reject}).then(function(event){return img.onload=function(){return _this.fileService.loadFile(img)},img.src=event.target.result,img})["catch"](function(error){return console.log(error)})},UploadComponent.prototype.loadPdf=function(newFile){var _this=this,reader=new FileReader;return reader.readAsArrayBuffer(newFile),new Promise(function(resolve,reject){reader.onload=resolve,reader.onerror=reject}).then(function(event){var res=event.target.result,typedarray=new Uint8Array(res);return PDFJS.getDocument(typedarray)}).then(function(pdf){return pdf.getPage(1)}).then(function(page){return _this.fileService.loadFile(page),page})["catch"](function(error){return console.log(error)})},UploadComponent.prototype.setDrawAndTextCanvasses=function(){this.canvasService.showDrawingCanvas(!0),this.canvasService.showTextCanvas(!0)},UploadComponent=__decorate([core_1.Component({template:'\n  <p>Upload een afbeelding (jpg, png) of pdf van je ID naar de browser.</p>\n  <p class="toelichting">Het bestand dat je straks downloadt heeft  dezelfde afmetingen als het geuploade bestand.</p>\n  <div class="fileUpload">\n  <label for="upload-button" class="topcoat-button--large">Bestand kiezen ...</label>\n  <input id="upload-button" type="file" accept=\'image/*,application/pdf\' (change)="onChange($event)">\n  </div>\n  '}),__metadata("design:paramtypes",[file_service_1.FileService,canvas_service_1.CanvasService])],UploadComponent)}();exports.UploadComponent=UploadComponent},402:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),Subject_1=__webpack_require__(69),CanvasService=function(){function CanvasService(){this.rotated=0,this.lineWidth=10,this.drawCv=null,this.textCv=null,this.textValue="",this.rotateSource=new Subject_1.Subject,this.drawingCanvasShowSource=new Subject_1.Subject,this.clearDrawingSource=new Subject_1.Subject,this.textCanvasShowSource=new Subject_1.Subject,this.clearTextSource=new Subject_1.Subject,this.textSource=new Subject_1.Subject,this.clearSelectedAreaSource=new Subject_1.Subject,this.widthHeightSource=new Subject_1.Subject,this.rotate$=this.rotateSource.asObservable(),this.drawingCanvasShow$=this.drawingCanvasShowSource.asObservable(),this.clearDrawing$=this.clearDrawingSource.asObservable(),this.textCanvasShow$=this.textCanvasShowSource.asObservable(),this.clearText$=this.clearTextSource.asObservable(),this.text$=this.textSource.asObservable(),this.clearSelectedArea$=this.clearSelectedAreaSource.asObservable(),this.widthHeight$=this.widthHeightSource.asObservable()}return CanvasService.prototype.rotate=function(rotation){this.rotated=this.rotated+rotation,this.rotateSource.next(this.rotated)},CanvasService.prototype.showDrawingCanvas=function(show){this.drawingCanvasShowSource.next(show)},CanvasService.prototype.clearDrawing=function(clear){this.clearDrawingSource.next(clear)},CanvasService.prototype.showTextCanvas=function(show){this.textCanvasShowSource.next(show)},CanvasService.prototype.clearText=function(clear){this.clearTextSource.next(clear),this.textValue=""},CanvasService.prototype.text=function(text){this.textSource.next(text),this.textValue=text},CanvasService.prototype.clearSelectedArea=function(clear){this.clearSelectedAreaSource.next(clear)},CanvasService.prototype.changeWidthHeight=function(wh){this.widthHeightSource.next(wh)},CanvasService=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],CanvasService)}();exports.CanvasService=CanvasService},403:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),Subject_1=__webpack_require__(69),FileService=function(){function FileService(){this.file=new Subject_1.Subject,this.fileLoaded=!1,this.changedFile$=this.file.asObservable()}return FileService.prototype.loadFile=function(file){this.useFile=file,this.fileLoaded=!0,this.file.next(file)},FileService=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],FileService)}();exports.FileService=FileService},404:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),canvas_service_1=__webpack_require__(402),file_service_1=__webpack_require__(403),RotateComponent=function(){function RotateComponent(fileService,canvasService){this.fileService=fileService,this.canvasService=canvasService,this.show=this.fileService.fileLoaded}return RotateComponent.prototype.rotateLeft=function(){this.canvasService.rotate(-90)},RotateComponent.prototype.rotateRight=function(){this.canvasService.rotate(90)},RotateComponent=__decorate([core_1.Component({template:'\n  <div *ngIf="show">\n    <p>Eventueel kun je de afbeelding roteren.</p>\n    <p class="toelichting">Het bestand dat je straks downloadt is niet geroteerd. Roteren is alleen om het bewerken in deze app te vergemakkelijken.</p>\n    <button class="topcoat-button--large" (click)="rotateLeft()">Roteer linksom</button>\n    <button class="topcoat-button--large" (click)="rotateRight()">Roteer rechtsom</button>\n  </div>\n  <p class="alert" *ngIf="!show">Je hebt nog geen afbeelding of pdf ge-upload.</p>\n  '}),__metadata("design:paramtypes",[file_service_1.FileService,canvas_service_1.CanvasService])],RotateComponent)}();exports.RotateComponent=RotateComponent},405:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),canvas_service_1=__webpack_require__(402),file_service_1=__webpack_require__(403),DrawComponent=function(){function DrawComponent(canvasService,fileService){this.canvasService=canvasService,this.fileService=fileService,this.show=this.fileService.fileLoaded}return DrawComponent.prototype.clear=function(){this.canvasService.clearDrawing(!0)},DrawComponent.prototype.setLineWidth=function(value){this.canvasService.lineWidth=value},DrawComponent=__decorate([core_1.Component({template:'\n  <div *ngIf="show">\n    <p>Trek met de muis een streep door je burger-servicenummer. Je moet de twee getypte, paginabrede regels onderaan je ID hebben. (In oudere paspoorten staat het BSN ook nog in rechts in het midden.)</p>\n    <button class="topcoat-button" (click)="clear()">Wis lijnen </button>\n    <label for="lijndikte">Pas lijndikte aan:</label>\n      <input id="lijndikte" class="topcoat-range" #input *ngIf="show" type="range" min="4" max="25" value="10" (change)="setLineWidth(input.value)">\n  </div>\n  <p class="alert" *ngIf="!show">Je hebt nog geen afbeelding of pdf ge-upload.</p>\n  '}),__metadata("design:paramtypes",[canvas_service_1.CanvasService,file_service_1.FileService])],DrawComponent)}();exports.DrawComponent=DrawComponent},406:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),canvas_service_1=__webpack_require__(402),file_service_1=__webpack_require__(403),TextComponent=function(){function TextComponent(canvasService,fileService){this.canvasService=canvasService,this.fileService=fileService,this.show=this.fileService.fileLoaded,this.inputvalue=this.canvasService.textValue}return TextComponent.prototype.clearText=function(){this.canvasService.clearText(!0),this.inputvalue=""},TextComponent.prototype.changeText=function(value){this.canvasService.text(value)},TextComponent.prototype.clearSelectedArea=function(){this.canvasService.clearSelectedArea(!0)},TextComponent=__decorate([core_1.Component({template:'\n  <div *ngIf="show">\n    <p>In het watermerk kun je aangeven voor wie de kopie van je ID bestemd is en waarvoor de kopie nodig is. De datum wordt automatisch toegevoegd.</p>\n    <p class="toelichting">Bijvoorbeeld: \'Kopie voor verhuurbedrijf Jansen & Janssens, bestemd als identificatie bij de huur van een feesttent.\'\n    <p>Om het gebied te verkleinen waar de tekst overheen komt: sleep met de muis.</p>\n      <textarea class="topcoat-textarea" [attr.rows]="4" [attr.cols]="28" #input [value]="inputvalue"  (keyup)="changeText(input.value)" placeholder="Tik je watermerk-tekst ..."></textarea>\n    <input class="topcoat-button" type="reset" (click)="clearText()" value="Wis tekst">\n    <button class="topcoat-button" (click)="clearSelectedArea()">Wis geselecteerde gebied</button>\n  </div>\n  <p class="alert" *ngIf="!show">Je hebt nog geen afbeelding of pdf ge-upload.</p>\n  '}),__metadata("design:paramtypes",[canvas_service_1.CanvasService,file_service_1.FileService])],TextComponent)}();exports.TextComponent=TextComponent},407:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),FS=__webpack_require__(408),toBlob=__webpack_require__(411),canvas_service_1=__webpack_require__(402),file_service_1=__webpack_require__(403),DownloadComponent=function(){function DownloadComponent(fileService,canvasService){this.fileService=fileService,this.canvasService=canvasService,this.offscreen=document.createElement("canvas"),this.viewportScale=1,this.file=this.fileService.useFile}return DownloadComponent.prototype.download=function(){this.file&&(this.file.hasOwnProperty("pageIndex")&&this.pdfOnCanvas(),this.file instanceof HTMLImageElement&&this.bitmapOnCanvas())},DownloadComponent.prototype.pdfOnCanvas=function(){var _this=this,pdf=this.file,canv=this.offscreen,ctx=canv.getContext("2d"),draw=this.canvasService.drawCv,text=this.canvasService.textCv;this.viewportScale=4.166667;var viewport=pdf.getViewport(this.viewportScale);canv.width=viewport.width,canv.height=viewport.height;var renderContext={canvasContext:ctx,viewport:viewport};pdf.render(renderContext).then(function(promise){draw&&_this.layerOnCanvas(draw,ctx),text&&_this.layerOnCanvas(text,ctx);var data=canv.toDataURL("image/jpeg",.6),blob=toBlob(data);return FS.saveAs(blob,"kopieID.jpg"),promise})},DownloadComponent.prototype.bitmapOnCanvas=function(){var img=this.file,canv=this.offscreen,ctx=canv.getContext("2d"),draw=this.canvasService.drawCv,text=this.canvasService.textCv;canv.width=img.width,canv.height=img.height,ctx.drawImage(img,0,0),draw&&this.layerOnCanvas(draw,ctx),text&&this.layerOnCanvas(text,ctx);var data=canv.toDataURL("image/jpeg",.6),blob=toBlob(data);FS.saveAs(blob,"kopieID.jpg")},DownloadComponent.prototype.layerOnCanvas=function(layer,ctx){var scale=this.viewportScale*(1/this.canvasService.scale),ratioSwitched=this.canvasService.rotated%180!==0;ctx.save(),ctx.scale(scale,scale),ratioSwitched===!0?(ctx.translate(layer.height/2,layer.width/2),ctx.rotate(-this.canvasService.rotated*Math.PI/180),ctx.translate(-layer.width/2,-layer.height/2)):(ctx.translate(layer.width/2,layer.height/2),ctx.rotate(-this.canvasService.rotated*Math.PI/180),ctx.translate(-layer.width/2,-layer.height/2)),ctx.drawImage(layer,0,0),ctx.restore()},DownloadComponent=__decorate([core_1.Component({template:'\n  <div *ngIf="file">\n    <p>Download je bestand. En klaar!</p>\n    <button class="topcoat-button--large" (click)="download()" [disabled]="!file">Download</button>\n  </div>\n  <p class="alert" *ngIf="!file">Je hebt nog geen afbeelding of pdf ge-upload.</p>\n  '}),__metadata("design:paramtypes",[file_service_1.FileService,canvas_service_1.CanvasService])],DownloadComponent)}();exports.DownloadComponent=DownloadComponent},412:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),router_1=__webpack_require__(339),canvas_service_1=__webpack_require__(402),AppComponent=function(){function AppComponent(canvasService,router){this.canvasService=canvasService,this.router=router}return AppComponent.prototype.ngOnInit=function(){var _this=this;this.router.events.subscribe(function(event){_this.setOrder(event.url),_this.canvasService.widthHeight$.subscribe(function(wh){_this.width=wh[0]+"px",_this.height=wh[1]+"px"})})},AppComponent.prototype.setOrder=function(url){var order;switch(url){case"/upload":order=11;break;case"/rotate":order=21;break;case"/draw":order=31;break;case"/text":order=41;break;case"/download":order=51;break;default:order=11}return void 0!==url&&(this.order=order),{order:this.order}},AppComponent=__decorate([core_1.Component({selector:"root",template:'\n  <div id="app">\n    <div class="nav-en-outlet">\n        <a routerLink="/upload" routerLinkActive="active">Uploaden</a>\n        <a routerLink="/rotate" routerLinkActive="active">Roteren</a>\n        <a routerLink="/draw" routerLinkActive="active">Burgerservicenummer verbergen</a>\n        <a routerLink="/text" routerLinkActive="active">Watermerk toevoegen</a>\n        <a routerLink="/download" routerLinkActive="active">Downloaden</a>\n      <div class="router-outlet" [ngStyle]="setOrder()">\n        <router-outlet></router-outlet>\n      </div>\n    </div>\n    <div class="canvas-container" [style.height]="height">\n      <bitmap></bitmap>\n      <pdf></pdf>\n      <draw></draw> \n      <text></text>\n    </div>\n  </div>\n  ',styles:[".canvas-container { position: relative }; text { pointer-events: none }"]}),__metadata("design:paramtypes",[canvas_service_1.CanvasService,router_1.Router])],AppComponent)}();exports.AppComponent=AppComponent},413:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),canvas_service_1=__webpack_require__(402),file_service_1=__webpack_require__(403),BitmapOnCanvas=function(){function BitmapOnCanvas(fileService,canvasService){this.fileService=fileService,this.canvasService=canvasService,this.show=!1,this.canvasMaxWidth=576,this.canvasMaxHeight=900}return BitmapOnCanvas.prototype.ngOnInit=function(){var _this=this;this.fileService.changedFile$.subscribe(function(file){if(console.log("file"),_this.file=file,file instanceof HTMLImageElement){var rotated=0,canvasParams=_this.computeCanvasParams(file,rotated);_this.setCanvasService(canvasParams.width,canvasParams.height,canvasParams.scale),_this.canv=_this.canvasView.nativeElement,_this.putOnCanvas(file,canvasParams,_this.canv)}else window.setTimeout(function(){_this.canvasWidth=0,_this.canvasHeight=0},10)}),this.canvasService.rotate$.subscribe(function(rotate){if(_this.file instanceof HTMLImageElement){var canvasParams=_this.computeCanvasParams(_this.file,rotate);_this.setCanvasService(canvasParams.width,canvasParams.height,canvasParams.scale),_this.putOnCanvas(_this.file,canvasParams,_this.canv)}})},BitmapOnCanvas.prototype.computeCanvasParams=function(file,rotated){var ratioSwitched=rotated%180!==0,actualWidth=file.width,actualHeight=file.height;ratioSwitched&&(actualWidth=file.height,actualHeight=file.width);var scale=1;actualWidth>this.canvasMaxWidth&&(scale=this.canvasMaxWidth/actualWidth),scale*actualHeight>this.canvasMaxHeight&&(scale=this.canvasMaxWidth/actualHeight);var canvasWidth=scale*actualWidth,canvasHeight=scale*actualHeight;return{width:canvasWidth,height:canvasHeight,scale:scale,rotated:rotated}},BitmapOnCanvas.prototype.setCanvasService=function(width,height,scale){this.canvasService.scale=scale,this.canvasService.height=height,this.canvasService.width=width,this.canvasService.changeWidthHeight([width,height])},BitmapOnCanvas.prototype.putOnCanvas=function(file,canvasParams,canvas){function drawImg(){ctx.translate(width/2,height/2),ctx.rotate(rotate*Math.PI/180),ratioSwitched?ctx.translate(-height/2,-width/2):ctx.translate(-width/2,-height/2),ctx.scale(scale,scale),ctx.drawImage(file,0,0)}var _this=this,scale=canvasParams.scale,width=canvasParams.width,height=canvasParams.height,rotate=canvasParams.rotated,ratioSwitched=rotate%180!==0,ctx=canvas.getContext("2d");this.canvasWidth=width,this.canvasHeight=height,window.setTimeout(function(){_this.canv.width=width,_this.canv.height=height,drawImg()},50)},__decorate([core_1.ViewChild("canvasBitmap"),__metadata("design:type",Object)],BitmapOnCanvas.prototype,"canvasView",void 0),BitmapOnCanvas=__decorate([core_1.Component({selector:"bitmap",template:'<canvas id="canvas-bitmap" #canvasBitmap [attr.width]="canvasWidth" [attr.height]="canvasHeight">Je browser is niet geschikt deze webtool.</canvas>',styles:["canvas { position: absolute }"]}),__metadata("design:paramtypes",[file_service_1.FileService,canvas_service_1.CanvasService])],BitmapOnCanvas)}();exports.BitmapOnCanvas=BitmapOnCanvas},414:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),canvas_service_1=__webpack_require__(402),file_service_1=__webpack_require__(403),PdfOnCanvas=function(){function PdfOnCanvas(canvasService,fileService){this.canvasService=canvasService,this.fileService=fileService,this.show=!1,this.canvasWidth=576,this.rotate=0}return PdfOnCanvas.prototype.ngOnInit=function(){var _this=this;this.fileSubscription=this.fileService.changedFile$.subscribe(function(file){file.hasOwnProperty("pageIndex")?(_this.show=!0,_this.file=file,window.setTimeout(function(){return _this.putOnCanvas(file)},0)):(_this.show=!1,_this.file=file)}),this.rotateSubscription=this.canvasService.rotate$.subscribe(function(rotate){_this.file.hasOwnProperty("pageIndex")&&_this.putOnCanvas(_this.file)})},PdfOnCanvas.prototype.putOnCanvas=function(file){var pdfWidth=file.view[2],pdfHeight=file.view[3],ratioSwitched=this.canvasService.rotated%180!==0,zoom=pdfWidth<this.canvasWidth?1:this.canvasWidth/pdfWidth,zoomRatioSwitched=pdfHeight<this.canvasWidth?1:this.canvasWidth/pdfHeight,scale=ratioSwitched?zoomRatioSwitched:zoom;this.canvasHeight=ratioSwitched?zoomRatioSwitched*pdfWidth:zoom*pdfHeight,this.canvasService.scale=scale,this.canvasService.height=this.canvasHeight,ratioSwitched?this.canvasService.width=pdfHeight<this.canvasWidth?pdfHeight:this.canvasWidth:this.canvasService.width=pdfWidth<this.canvasWidth?pdfWidth:this.canvasWidth;var canv=this.canvas.nativeElement,ctx=canv.getContext("2d"),viewport=file.getViewport(scale,this.canvasService.rotated);canv.width=viewport.width,canv.height=viewport.height,canv.style.border="1px solid black";var renderContext={canvasContext:ctx,viewport:viewport};file.render(renderContext),this.canvasService.changeWidthHeight([viewport.width,viewport.height])},__decorate([core_1.ViewChild("canvas"),__metadata("design:type",Object)],PdfOnCanvas.prototype,"canvas",void 0),PdfOnCanvas=__decorate([core_1.Component({selector:"pdf",template:'\n  <canvas *ngIf="show" #canvas>Je browser is niet geschikt deze webtool.</canvas>\n  ',styles:["canvas { position: absolute }"]}),__metadata("design:paramtypes",[canvas_service_1.CanvasService,file_service_1.FileService])],PdfOnCanvas)}();exports.PdfOnCanvas=PdfOnCanvas},415:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),router_1=__webpack_require__(339),canvas_service_1=__webpack_require__(402),DrawingOnCanvas=function(){function DrawingOnCanvas(canvasService,router){this.canvasService=canvasService,this.router=router,this.show=!1,this.started=!1}return DrawingOnCanvas.prototype.ngOnInit=function(){var _this=this;this.router.events.subscribe(function(event){"NavigationEnd"===event.toString().substring(0,13)&&(_this.currentUrl=event.url)})},DrawingOnCanvas.prototype.ngAfterViewInit=function(){var _this=this;this.showSubscription=this.canvasService.drawingCanvasShow$.subscribe(function(show){_this.show=show,1==show&&window.setTimeout(function(){return _this.setupCanvasses()},250)}),this.clearSubscription=this.canvasService.clearDrawing$.subscribe(function(clear){_this.clear(),_this.clearCanvasServiceDrawCv()}),this.rotateSubscription=this.canvasService.rotate$.subscribe(function(rotate){1==_this.show&&(_this.clear(),_this.clearCanvasServiceDrawCv(),_this.setupCanvasses())})},DrawingOnCanvas.prototype.setupCanvasses=function(){this.temp_cv=this.temp.nativeElement,this.temp_cv.width=this.canvasService.width,this.temp_cv.height=this.canvasService.height,this.temp_ctx=this.temp_cv.getContext("2d"),this.view_cv=this.view.nativeElement,this.view_cv.width=this.canvasService.width,this.view_cv.height=this.canvasService.height,this.view_ctx=this.view_cv.getContext("2d")},DrawingOnCanvas.prototype.startLine=function(ev){this.started=!0,this.x0=ev.offsetX,this.y0=ev.offsetY},DrawingOnCanvas.prototype.drawLine=function(ev){this.started&&(this.temp_ctx.clearRect(0,0,this.temp_cv.width,this.temp_cv.height),this.temp_ctx.beginPath(),this.temp_ctx.moveTo(this.x0,this.y0),this.temp_ctx.lineWidth=this.canvasService.lineWidth,this.temp_ctx.lineCap="round",this.temp_ctx.lineTo(ev.offsetX,ev.offsetY),this.temp_ctx.stroke(),this.temp_ctx.closePath(),this.mouseEventCache=ev)},DrawingOnCanvas.prototype.endLine=function(ev){this.started&&(this.started=!1,this.img_update(),this.updateCanvasServiceDrawCv())},DrawingOnCanvas.prototype.onMouseup=function(event){this.endLine(this.mouseEventCache)},DrawingOnCanvas.prototype.img_update=function(){return this.view_ctx.drawImage(this.temp_cv,0,0),this.temp_ctx.clearRect(0,0,this.temp_cv.width,this.temp_cv.height),this.temp_cv},DrawingOnCanvas.prototype.clear=function(){this.view_ctx&&this.view_ctx.clearRect(0,0,this.temp_cv.width,this.temp_cv.height)},DrawingOnCanvas.prototype.updateCanvasServiceDrawCv=function(){this.canvasService.drawCv=this.view_cv},DrawingOnCanvas.prototype.clearCanvasServiceDrawCv=function(){
this.canvasService.drawCv=null},__decorate([core_1.ViewChild("temp"),__metadata("design:type",Object)],DrawingOnCanvas.prototype,"temp",void 0),__decorate([core_1.ViewChild("view"),__metadata("design:type",Object)],DrawingOnCanvas.prototype,"view",void 0),__decorate([core_1.HostListener("document:mouseup",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],DrawingOnCanvas.prototype,"onMouseup",null),DrawingOnCanvas=__decorate([core_1.Component({selector:"draw",template:'\n  <div *ngIf="show">\n  <canvas #view></canvas>\n  <canvas id="temp" #temp (mousedown)="startLine($event)" (mousemove)="drawLine($event)" (mouseup)="endLine($event)" [style.pointer-events]="currentUrl ===\'/draw\' ? \'auto\' : \'none\' "></canvas>\n  </div>\n  ',styles:["canvas { position: absolute }"]}),__metadata("design:paramtypes",[canvas_service_1.CanvasService,router_1.Router])],DrawingOnCanvas)}();exports.DrawingOnCanvas=DrawingOnCanvas},416:function(module,exports,__webpack_require__){"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=this&&this.__metadata||function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},core_1=__webpack_require__(11),router_1=__webpack_require__(339),canvas_service_1=__webpack_require__(402),TextOnCanvas=function(){function TextOnCanvas(canvasService,router){this.canvasService=canvasService,this.router=router,this.show=!1,this.started=!1}return TextOnCanvas.prototype.ngOnInit=function(){var _this=this;this.router.events.subscribe(function(event){"NavigationEnd"===event.toString().substring(0,13)&&(_this.currentUrl=event.url)})},TextOnCanvas.prototype.ngAfterViewInit=function(){var _this=this;this.showSubscription=this.canvasService.textCanvasShow$.subscribe(function(show){_this.show=show,1==show&&window.setTimeout(function(){return _this.setupCanvasses()},250)}),this.clearSubscription=this.canvasService.clearText$.subscribe(function(clear){_this.clearText(),_this.clearCanvasServiceTextCv()}),this.rotateSubscription=this.canvasService.rotate$.subscribe(function(rotate){1==_this.show&&(_this.clearText(),_this.clearCanvasServiceTextCv(),_this.clearSelectedArea(),_this.setupCanvasses())}),this.textSubscription=this.canvasService.text$.subscribe(function(text){_this.clearText(),_this.img_update(text),_this.updateCanvasServiceTextCv()}),this.clearSelectedAreaSubscription=this.canvasService.clearSelectedArea$.subscribe(function(clear){_this.clearSelectedArea()})},TextOnCanvas.prototype.setupCanvasses=function(){var w=this.canvasService.width,h=this.canvasService.height;this.temprect_cv=this.temp.nativeElement,this.temprect_cv.width=w,this.temprect_cv.height=h,this.temprect_ctx=this.temprect_cv.getContext("2d"),this.rect_cv=this.rect.nativeElement,this.rect_cv.width=w,this.rect_cv.height=h,this.rect_ctx=this.rect_cv.getContext("2d"),this.text_cv=this.textcanvas.nativeElement,this.text_cv.width=w,this.text_cv.height=h,this.text_ctx=this.text_cv.getContext("2d"),this.text_ctx.textAlign="center",this.text_ctx.textBaseline="middle",this.canvasService.textAreaDimensions=this.computeTextDimensions(0,0,w,h),this.adjustTextAreaDimensions()},TextOnCanvas.prototype.startSelection=function(ev){this.rect_ctx.clearRect(0,0,this.rect_cv.width,this.rect_cv.height),this.text_ctx.restore(),this.text_ctx.clearRect(0,0,this.text_cv.width,this.text_cv.height),this.started=!0,this.x0=ev.offsetX,this.y0=ev.offsetY},TextOnCanvas.prototype.dragSelection=function(ev){if(this.started){this.temprect_ctx.clearRect(0,0,this.temprect_cv.width,this.temprect_cv.height);var width=ev.offsetX-this.x0,height=ev.offsetY-this.y0;this.temprect_ctx.fillStyle="rgba(0,0,0,0.1)",this.temprect_ctx.fillRect(this.x0,this.y0,width,height),this.mouseEventCache=ev}},TextOnCanvas.prototype.endSelection=function(ev){this.started&&(this.dragSelection(ev),this.started=!1,this.canvasService.textAreaDimensions=this.computeTextDimensions(this.x0,this.y0,ev.offsetX,ev.offsetY),this.adjustTextAreaDimensions(),this.rect_update(),this.img_update(this.canvasService.textValue))},TextOnCanvas.prototype.onMouseup=function(event){this.endSelection(this.mouseEventCache)},TextOnCanvas.prototype.computeTextDimensions=function(x1,y1,x2,y2){var x=Math.min(x1,x2),y=Math.min(y1,y2),w=Math.abs(x1-x2),h=Math.abs(y1-y2);return[x,y,w,h]},TextOnCanvas.prototype.adjustTextAreaDimensions=function(){var x=this.canvasService.textAreaDimensions[0],y=this.canvasService.textAreaDimensions[1],w=this.canvasService.textAreaDimensions[2],h=this.canvasService.textAreaDimensions[3];this.text_ctx.save();var angle=Math.atan(h/w);this.text_ctx.translate(x+w/2,y+h/2),this.text_ctx.rotate(-angle)},TextOnCanvas.prototype.rect_update=function(){this.rect_ctx.drawImage(this.temprect_cv,0,0),this.temprect_ctx.clearRect(0,0,this.temprect_cv.width,this.temprect_cv.height)},TextOnCanvas.prototype.img_update=function(text){var w=this.canvasService.textAreaDimensions[2],h=this.canvasService.textAreaDimensions[3],diagonal=Math.sqrt(w*w+h*h),fontSize=diagonal/30;this.text_ctx.font=fontSize+"px sans-serif",this.text_ctx.save(),this.text_ctx.fillStyle="rgba(0,0,0,0.2)";var datum="";""!==this.canvasService.textValue&&(datum="datum: "+(new Date).toLocaleDateString());var maxCharsPerLine=55,breakString=[".{1,",maxCharsPerLine,"}([\\.,\\s!\\?]|$)"].join(""),breakStringRegExp=new RegExp(breakString,"g");if(text.length<=maxCharsPerLine)this.text_ctx.fillText(text,0,0),this.text_ctx.fillText(datum,0,1.2*fontSize);else{var text1=text.match(breakStringRegExp)[0],text2=text.match(breakStringRegExp)[1];this.text_ctx.fillText(text1,0,-1.2*fontSize),this.text_ctx.fillText(text2,0,0),this.text_ctx.fillText(datum,0,1.2*fontSize)}this.text_ctx.restore()},TextOnCanvas.prototype.clearText=function(){this.text_ctx&&(this.text_ctx.restore(),this.text_ctx.clearRect(0,0,this.text_cv.width,this.text_cv.height),this.adjustTextAreaDimensions())},TextOnCanvas.prototype.clearSelectedArea=function(){this.rect_ctx.clearRect(0,0,this.rect_cv.width,this.rect_cv.height);var w=this.text_cv.width,h=this.text_cv.height;this.canvasService.textAreaDimensions=this.computeTextDimensions(0,0,w,h),this.clearText(),this.img_update(this.canvasService.textValue)},TextOnCanvas.prototype.updateCanvasServiceTextCv=function(){this.canvasService.textCv=this.text_cv},TextOnCanvas.prototype.clearCanvasServiceTextCv=function(){this.canvasService.textCv=null},__decorate([core_1.ViewChild("temp"),__metadata("design:type",Object)],TextOnCanvas.prototype,"temp",void 0),__decorate([core_1.ViewChild("rect"),__metadata("design:type",Object)],TextOnCanvas.prototype,"rect",void 0),__decorate([core_1.ViewChild("textcanvas"),__metadata("design:type",Object)],TextOnCanvas.prototype,"textcanvas",void 0),__decorate([core_1.HostListener("document:mouseup",["$event"]),__metadata("design:type",Function),__metadata("design:paramtypes",[Object]),__metadata("design:returntype",void 0)],TextOnCanvas.prototype,"onMouseup",null),TextOnCanvas=__decorate([core_1.Component({selector:"text",template:'\n  <div *ngIf="show">\n    <canvas #rect style="pointer-events:none"></canvas>\n    <canvas #textcanvas style="pointer-events:none"></canvas>\n    <canvas #temp (mousedown)="startSelection($event)" (mousemove)="dragSelection($event)" (mouseup)="endSelection($event)" [style.pointer-events]="currentUrl ===\'/text\' ? \'all\' : \'none\' "></canvas>\n  </div>\n  ',styles:["canvas { position: absolute }"]}),__metadata("design:paramtypes",[canvas_service_1.CanvasService,router_1.Router])],TextOnCanvas)}();exports.TextOnCanvas=TextOnCanvas},417:function(module,exports){}});
//# sourceMappingURL=app.946dbee589d02ea0342d.js.map