!function(){function t(){var t=d3.select(this),e="abs-button"===this.id?d3.select("#rel-button"):d3.select("#abs-button");t.classed("active")||(t.classed("active",!0),e.classed("active",!1),"abs-button"===this.id?(d3.selectAll(".abs").style("visibility","visible"),d3.selectAll(".rel").style("visibility","hidden")):(d3.selectAll(".abs").style("visibility","hidden"),d3.selectAll(".rel").style("visibility","visible")))}function e(t,e,a){c.append("rect").attr("x",t).attr("y",e).attr("width",17).attr("height",17).style("fill",a.color),c.append("text").attr("x",t+20).attr("y",e+12).style("font-size","1.2em").text(a.description)}function a(t,e){return{label:t.aantal_of_per10000+"&"+t.wijze,value:+t[e]}}function r(t,e){var r=t.values,n=e.map(function(t){var e={};return e.year=t,r.forEach(function(r){return e[a(r,t).label]=+a(r,t).value}),e});return{key:t.key,values:n}}var n=d3.formatLocale({decimal:",",thousands:".",grouping:[3],currency:["â‚¬",""]}).format(","),i=d3.select("#viz"),l=i.append("div").attr("id","buttons");l.append("button").attr("id","abs-button").attr("class","w3-button w3-margin active").text("Totaal aantal").on("click",t),l.append("button").attr("id","rel-button").attr("class","w3-button w3-margin").text("Per 10.000 inwoners").on("click",t);var c=i.append("div").attr("id","legend").append("svg").attr("viewBox","0 0 320 120"),s=[{description:"Dagopname",color:"#f1c40f"},{description:"Klinisch",color:"#c0392b"},{description:"Dagopname, specifiek (laparoscopisch of secundair)",color:"#f39c12"},{description:"Klinisch, specifiek (laparoscopisch of secundair)",color:"#e74c3c"}];e(4,20,s[0]),e(4,45,s[1]),e(4,70,s[2]),e(4,95,s[3]);var o=i.append("div").attr("id","big-total-chart-container"),p=i.append("div").attr("id","chart-container"),d={top:10,right:20,bottom:20,left:66},u=650-d.right-d.left,v=150-d.top-d.bottom,f=d3.scaleTime().domain([new Date(1995,0,1),new Date(2010,0,1)]).range([0,u]),h=d3.axisBottom(f).tickSizeInner(6).tickSizeOuter(0),y=d3.scaleLinear().range([v,0]),k=d3.axisLeft(y).ticks(4).tickFormat(n),b={top:10,right:20,bottom:20,left:60},g=310-b.right-b.left,m=100-b.top-b.bottom,w=d3.scaleTime().domain([new Date(1995,0,1),new Date(2010,0,1)]).range([0,g]),x=d3.axisBottom(w).tickSizeInner(6).tickSizeOuter(0),A=d3.scaleLinear().range([m,0]),L=d3.axisLeft(A).ticks(3).tickSizeOuter(0).tickFormat(n),T=3*m,_=d3.scaleLinear().range([T,0]),z=d3.axisLeft(_).ticks(3).tickSizeOuter(0).tickFormat(n);d3.csv("operaties-1995-2010.csv",function(t,e){function a(t,e){var a,r,l,o,p=w,d=x;switch(t.key){case"Alle operatieve verrichtingen BIG TOTAL":a="abs"===e?15e5:1e3,y.domain([0,a]),r=v,p=f,d=h,l=y,o=k;break;case"Alle operatieve verrichtingen":a="abs"===e?15e5:1e3,A.domain([0,a]),r=m,l=A,o=L;break;case"Staaroperatie":a="abs"===e?15e4:90,_.domain([0,a]),r=T,l=_,o=z;break;default:a="abs"===e?5e4:30,A.domain([0,a]),r=m,l=A,o=L}var u=d3.keys(t.values[0]).filter(function(t){return"year"!==t}),b=d3.stack().keys(u),g=d3.area().x(function(t){return p(new Date(+t.data.year,0,0))}).y1(function(t){return l(t[1])}).y0(function(t){return l(t[0])}),B=d3.select("#"+t.key.toLowerCase().replace(/[\s/,\.]/g,"")).select("svg").select("g");B.append("g").attr("class",e).selectAll("path").data(function(){return b(t.values)}).enter().append("path").attr("d",function(t){return g(t)}).attr("fill",function(t){return function(t){var e=t.split(" ")[0],a=t.split("&")[1];return"dagopname"===e?"enkel"===a||"overig"===a?s[0].color:s[2].color:"enkel"===a||"overig"===a||"open"===a?s[1].color:s[3].color}(t.key)}),B.append("g").attr("class","y axis "+e).call(o),"abs"===e&&(B.append("g").attr("class","x axis").attr("transform","translate(0, "+r+")").call(d),B.append("text").attr("x",6).attr("y",8).attr("class","chart-label").text("Alle operatieve verrichtingen BIG TOTAL"===t.key?"Alle operatieve verrichtingen":t.key)),B.append("rect").attr("class",e).attr("x",0).attr("y",0).attr("width",p(new Date(+c[c.length-1],0,1))).attr("height",l(0)).attr("opacity","0.0001").on("click",function(){return function(t,e){var a=i.append("div").attr("class","w3-modal").style("display","block"),r=a.append("div").attr("class","w3-modal-content"),l=r.append("div").attr("class","w3-container modal-header");l.append("h5").text("Alle operatieve verrichtingen BIG TOTAL"===t.key?"Alle operatieve verrichtingen":t.key),l.append("p").text("abs"===e?"(totaal aantal)":"(per 10.000 inwoners)"),l.append("span").attr("class","w3-button w3-display-topright").on("click",function(){return a.style("display","none")}).html("&times;");var c=r.append("div").attr("class","w3-container").append("table").attr("class","w3-table-all w3-small w3-margin-top w3-margin-bottom"),s=d3.keys(t.values[0]).map(function(t){return t.replace(/aantal&|per 10000 inw&/,"").replace(/year|enkel/,"").replace("laparoscopisch","laparo&shy;scopisch").replace("transurethraal","trans&shy;urethraal")}),o=c.append("tr");s.forEach(function(t){o.append("th").html(t)}),c.selectAll("tr").data(t.values).enter().append("tr").selectAll("td").data(function(t){return d3.values(t)}).enter().append("td").text(function(t,e){return e>0?n(+t):t})}(t,e)})}var l=d3.nest().key(function(t){return t.operatie}).entries(e);l.unshift({key:l[0].key,values:l[0].values}),l[0].key="Alle operatieve verrichtingen BIG TOTAL";var c=d3.keys(e[0]).slice(0,16),B=l.map(function(t){return{key:t.key,values:t.values.filter(function(t){return"klinisch aantal"===t.aantal_of_per10000||"dagopname aantal"===t.aantal_of_per10000})}}),O=l.map(function(t){return{key:t.key,values:t.values.filter(function(t){return"klinisch per 10000 inw"===t.aantal_of_per10000||"dagopname per 10000 inw"===t.aantal_of_per10000})}}),D=B.map(function(t){return r(t,c)}),S=O.map(function(t){return r(t,c)});D.forEach(function(t){var e=m,a=g,r=b,n="regular-chart",i=p;switch(t.key){case"Alle operatieve verrichtingen BIG TOTAL":e=v,a=u,r=d,n="total-chart",i=o;break;case"Staaroperatie":e=T,n="large-chart"}i.append("div").attr("id",t.key.toLowerCase().replace(/[\s/,\.]/g,"")).attr("class","chart "+n).append("svg").attr("viewBox","0 0 "+(a+r.left+r.right)+" "+(e+r.top+r.bottom)).append("g").attr("transform","translate("+r.left+", "+r.top+")")}),D.forEach(function(t){return a(t,"abs")}),S.forEach(function(t){return a(t,"rel")}),d3.selectAll(".rel").style("visibility","hidden")})}();
//# sourceMappingURL=operaties.min.js.map
