function viz(){var e={};d3.formatDefaultLocale({decimal:",",thousands:".",grouping:[3],currency:["â‚¬",""]});var t,a,r,n,l,o={VVD:{fullName:"VVD",color:"#455493"},PVDA:{fullName:"PvdA",color:"#9A0D1B"},PVV:{fullName:"PVV",color:"#1fbbfb"},SP:{fullName:"SP",color:"#C73D77"},D66:{fullName:"D66",color:"#4AAB2D"},CDA:{fullName:"CDA",color:"#00894B"},GROENLINKS:{fullName:"GroenLinks",color:"#006B39"},CU:{fullName:"ChristenUnie",color:"#032863"},PVDD:{fullName:"Partij vd Dieren",color:"#eac134"},OVERIGE:{fullName:"Overige partijen",color:"#bebebf"},BLANCO_ONG:{fullName:"Blanco en ongeldige stemmen",color:"#ccc"},PVDO:{fullName:"Partij van de Ouderen",color:"#4D9ED6"},HSP:{fullName:"Haagse Stadspartij",color:"#CDC52A"},GDM_OP:{fullName:"Groep de Mos, Ouderenpartij",color:"#157F3D"},CU_SGP:{fullName:"ChristenUnie, SGP",color:"#032863"},ID:{fullName:"Islam Democraten",color:"#7BBD30"},PVDE:{fullName:"Partij van de Eenheid",color:"#19803D"},LEEFBAAR:{fullName:"Leefbaar Rotterdam",color:"#359C32"},NIDA:{fullName:"Nida Rotterdam",color:"#65AC20"},SBU:{fullName:"Stadsbelang Utrecht",color:"#D70015"},S_S:{fullName:"Student & Starter",color:"#31B5CE"}},i={amsterdam:{fullName:"Amsterdam",center:[4.975,52.354],scale:11e4},rotterdam:{fullName:"Rotterdam",center:[4.478,51.91],scale:83400},denhaag:{fullName:"Den Haag",center:[4.364,52.071],scale:15e4},utrecht:{fullName:"Utrecht",center:[5.141,52.081],scale:14e4}},c=d3.select("#viz"),s="abs",d=c.append("div").attr("id","selects-container").attr("class","w3-row-padding");d.append("div").attr("id","select-city").append("select").on("change",function(){e.getData(this.value),d3.select("#select-abs-perc select").property("value",s),U()}).selectAll("option").data(d3.entries(i)).enter().append("option").attr("value",function(e){return e.key}).text(function(e){return e.value.fullName});var p=d.append("div").attr("id","select-party").append("select").on("change",function(){a=this.value,e.color(a),U()});d.append("div").attr("id","select-abs-perc").append("select").on("change",function(){s=this.value,e.color(a),U()}).selectAll("option").data(d3.entries({abs:"Aantal",perc:"Percentage"})).enter().append("option").attr("value",function(e){return e.key}).text(function(e){return e.value}),d3.selectAll("#selects-container div").attr("class","w3-third").selectAll("select").attr("class","w3-select");var u=0,f=0,m=0,v=14,g=670-v-f,h=50-u-m,N=c.append("div").attr("id","legend-container").style("padding-bottom",100*(h+u+m)/(g+v+f)+"%"),b=function(){return 25/450*d3.select("canvas").property("clientWidth")+"px"},A=N.append("canvas").attr("width",450+v).attr("height",1).style("width",(450+v)/g*100+"%").style("height",b());window.onresize=function(){return A.style("height",b())};var D=function(e,t,a){for(var r=e.node().getContext("2d"),n=r.createImageData(450+v,1),o=0,i=-1,c=void 0;o<450;++o)c=d3.rgb(t(o*l[a][s]/450)),n.data[++i]=c.r,n.data[++i]=c.g,n.data[++i]=c.b,n.data[++i]=255;r.putImageData(n,v,0)},w=N.append("svg").attr("viewBox","0 0 "+(g+v+f)+" "+(h+u+m)).append("g").attr("transform","translate("+v+", "+u+")"),y=(d3.scaleLinear().domain([0,450]).range([0,450]),d3.scaleLinear().range([0,449])),E=d3.axisBottom(y).tickSize(-25).tickPadding(8).ticks(6),x=w.append("g").attr("id","legend-axis").attr("transform","translate(0, 25)"),M=0,S=10,C=0,P=10,B=670-P-S,k=500-M-C,V=c.append("div").attr("id","map-container").style("padding-bottom",100*(k+M+C)/(B+P+S)+"%").append("svg").attr("viewBox","0 0 "+(B+P+S)+" "+(k+M+C)).append("g").attr("transform","translate("+P+", "+M+")"),j=c.append("div").attr("id","district-textinfo-container").attr("class","w3-container w3-pale-yellow").append("p"),U=function(){return j.text("Wil je de precieze uitslag van een buurt? Klik op de kaart.")};U();var O=c.append("div").attr("id","table-container").attr("class","w3-container"),T=O.append("h5"),G=O.append("table").attr("class","w3-table w3-border w3-bordered");return G.append("tr").attr("class","w3-light-grey").selectAll("th").data(["","aantal stemmen","percentage"]).enter().append("th").text(function(e){return e}),e.getData=function(t){d3.selectAll("select").property("disabled",!0);var a="data/"+t+"-topo.json";d3.json(a,function(a,r){if(a)throw d3.select("#map-svg-container").remove(),c.append("p").text("Er is een probleem met het laden van de data. Misschien lukt het wel als je de pagina ververst.").attr("class","w3-container w3-win-metro-red"),a;var n=topojson.feature(r,r.objects.stad);e.processCityData(n),e.drawCity(t,n),e.writeTable(t),d3.selectAll("select").property("disabled",!1)})},e.processCityData=function(e){var t=["BU_CODE","BU_NAAM","KIESGER","STEMMEN"];(r=d3.keys(e.features[0].properties).filter(function(e){return-1===t.indexOf(e)})).push(r.shift());var a={},o={};return n={voters:0},r.forEach(function(e){a[e]=[],o[e]=[],n[e]=0}),e.features.filter(function(e){return-1!==e.properties.STEMMEN}).forEach(function(e){var t=e.properties.STEMMEN;n.voters+=t,r.forEach(function(r){var l=e.properties[r];a[r].push(l),o[r].push(l/t),n[r]+=l})}),l={},r.forEach(function(e){l[e]={abs:d3.max(a[e]),perc:d3.max(o[e])}}),{cityParties:r,totalCityVotes:n,partiesVotesMax:l}},e.drawCity=function(n,l){p.selectAll("option").remove(),p.selectAll("option").data(r).enter().append("option").attr("value",function(e){return e}).text(function(e){return o[e].fullName});var c=d3.geoMercator().center(i[n].center).scale(i[n].scale),s=d3.geoPath().projection(c);d3.select("#city-districts").remove(),t=V.append("g").attr("id","city-districts").selectAll("path").data(l.features).enter().append("path").attr("d",s),a=r[0],e.color(a)},e.writeTable=function(e){T.text("Totaal van alle buurten in "+e.replace(/\b\w/g,function(e){return e.toUpperCase()}));var t=d3.entries(n);t.push(t.shift());var a=G.selectAll(".party-row").data(t),r=function(e){var t=[];return t.push("voters"===e.key?"Totaal":o[e.key].fullName),t.push(d3.format(",.0f")(e.value)),t.push(d3.format(".1%")(e.value/n.voters)),t};a.selectAll("td").data(r).text(function(e){return e});a.enter().append("tr").attr("class","party-row").selectAll("td").data(r).enter().append("td").text(function(e){return e});a.exit().remove()},e.color=function(e){y.domain([0,l[e][s]]),"abs"===s?E.tickFormat(d3.format(",.0f")):E.tickFormat(d3.format(".0%")),x.call(E);var a=o[e].color,r=d3.interpolateHcl("#fbfdda",a),n=d3.scaleSequential(r).domain([0,l[e][s]]);A.call(D,n,e);var i=function(e){return j.text(e.properties.BU_NAAM+": er was in deze buurt geen stembureau.")};"abs"===s?t.style("fill",function(t){return-1!==t.properties[e]?n(t.properties[e]):"#fff"}).on("click",function(t){-1===t.properties.STEMMEN?i(t):j.text(o[e].fullName+", "+t.properties.BU_NAAM+": "+t.properties[e]+" stemmen.")}):t.style("fill",function(t){return-1!==t.properties[e]?n(t.properties[e]/t.properties.STEMMEN):"#fff"}).on("click",function(t){-1===t.properties.STEMMEN?i(t):j.text(o[e].fullName+", "+t.properties.BU_NAAM+" : "+d3.format(".1%")(t.properties[e]/t.properties.STEMMEN)+".")})},e}viz().getData("amsterdam");
//# sourceMappingURL=verkiezingsuitslagen.min.js.map
