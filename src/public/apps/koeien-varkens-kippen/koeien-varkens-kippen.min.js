function draw(){var t={varkens:"#ff0097",koeien:"#2d89ef",schapen:"#00a300",kippen:"#ffc40d",mensen:"#da532c"},n={Nederland:"NL","België":"BE",Denemarken:"DK",Duitsland:"DE",Frankrijk:"FR","Italië":"IT",Spanje:"ES","Verenigd Koninkrijk":"GB"},a=d3.select("#viz");a.selectAll("div").remove();var e,r;a.append("div").attr("id","button-container").append("button").attr("class","w3-button w3-round").text("stop animatie").on("click",function(){var t=d3.select(this);"stop animatie"===t.text()?(e.stop(),t.text("start animatie")):(r(),e=d3.interval(r,6e3),t.text("stop animatie"))});var i,o,d,l,s=(i=window.matchMedia("(max-width: 400px)").matches?{height:1100,animalChartsPerRow:1,countryChartsPerRow:2,maxBars:"country",scale:2,legendTranslate:-450}:window.matchMedia("(max-width: 600px)").matches?{height:825,animalChartsPerRow:2,countryChartsPerRow:3,maxBars:"animal",scale:1.5,legendTranslate:-300}:window.matchMedia("(max-width: 800px)").matches?{height:550,animalChartsPerRow:2,countryChartsPerRow:4,maxBars:"country",scale:1.2,legendTranslate:-150}:{height:550,animalChartsPerRow:3,countryChartsPerRow:4,maxBars:"animal",scale:1,legendTranslate:-20}).animalChartsPerRow,c=Math.ceil(5/s),u=i.countryChartsPerRow,p=0,f=10,m=6,h=0,y=120,x=40,w=18,g=20,v=895-h-f,k=i.height-p-m;"country"===i.maxBars?(o=v/u,l=Math.floor((o-g-x)/5),d=8*l+g+x):(d=v/s,l=Math.floor((d-g-x)/8),o=5*l+g+x);var b=k/(c+1),R=d3.range(6).map(function(t){return Math.floor(t%s*d)}),C=d3.range(6).map(function(t){return(2+Math.floor(t/s))*b}),B=d3.zip(R,C),M=d3.range(8).map(function(t){return Math.floor(t%u*o)}),P=d3.range(8).map(function(t){return(2+Math.floor(t/u))*b}),I=d3.zip(M,P),W=a.append("div").attr("id","svg-container").style("padding-bottom",100*(k+p+m)/(v+h+f)+"%").append("svg").attr("viewBox","0 0 "+(v+h+f)+" "+(k+p+m)).append("g").attr("transform","translate("+h+", "+p+")");W.append("g").attr("id","header").append("text").attr("transform","scale("+i.scale+") translate("+(370+i.legendTranslate/1.5)+",12)").text("Aantal dieren en mensen per km2").style("text-transform","uppercase"),d3.csv("koeien-varkens-kippen.csv",function(s,c){if(s)throw d3.select("#svg-container").remove(),a.append("p").text("Er is een probleem met het laden van de data. Misschien lukt het wel als je de pagina ververst.").attr("class","w3-container w3-win-metro-red"),s;var u=d3.map(c,function(t){return t.country}),p=u.keys(),f=Object.keys(u.get(p[0])).filter(function(t){return"country"!==t&&"surface"!==t}),m=d3.permute(f,[3,4,2,1,0]),h=W.append("g").attr("id","legend-container").attr("transform","scale("+i.scale+") translate("+i.legendTranslate+",0)").selectAll(".legend").data(m).enter().append("g").attr("class","legend").attr("transform",function(t,n){return"translate(0, "+22*n+")"});h.append("rect").attr("x",v-38).attr("width",18).attr("height",18).style("fill",function(n){return t[n]}),h.append("text").attr("x",v-44).attr("y",9).attr("dy",".35em").style("text-anchor","end").style("font-size","80%").text(function(t){return t});var k=m.reduce(function(t,n,a){return t[n]={x:B[a][0]+g,y:B[a][1]-w},t},{}),R=p.reduce(function(t,n,a){return t[n]={x:I[a][0]+g,y:I[a][1]-w},t},{}),C=d3.scaleBand().domain(p.map(function(t){return n[t]})).rangeRound([0,d-g-x]).paddingInner(.5),M=d3.axisBottom(C),P=d3.scaleBand().domain(m).rangeRound([0,o-g-x]).paddingInner(.4),z=d3.scaleLinear().domain([0,1500]).clamp(!0).rangeRound([0,-(2*b-y-w)]),A=W.append("g").attr("id","animal-axes-container").selectAll(".animal-axis").data(m).enter().append("g").attr("class","animal-axis").attr("transform",function(t){return"translate("+(k[t].x+6*i.scale)+", "+k[t].y+")"}).call(M).style("font-size",9.8*i.scale+"px"),T=W.append("g").attr("id","chartlabel-container");d3.keys(R).forEach(function(t){var n=R[t],a=n.x+.5*(o-g-x);T.append("text").attr("class","chart-label").attr("text-anchor","middle").attr("x",a).attr("y",n.y+16*i.scale).style("font-size",12*i.scale+"px").text(t)});var E=W.selectAll(".bars-container").data(u.entries()).enter().append("g").attr("class","bars-container").selectAll("g").data(function(t){var n=d3.map(t.value);return n.keys().filter(function(t){return"country"!==t}).map(function(t){return{key:t,value:+n.get(t)/+n.get("surface")}}).filter(function(t){return"surface"!==t.key})}).enter().append("g").datum(function(t){return{country:d3.select(this.parentNode).datum().key,animal:t.key,value:Math.round(t.value)}}).attr("class",function(t){return n[t.country].toLowerCase()+" "+t.animal}),L=E.append("rect").attr("width",l).attr("y",function(t){return z(+t.value)}).attr("height",function(t){return-z(+t.value)}).style("fill",function(n){return t[n.animal]}),N=d3.select(".nl.kippen").append("rect").attr("width",l+2).attr("height",-z(1360)).attr("y",z(1360)-80).style("fill",t.kippen).style("stroke","#fff").style("stroke-width",3),j=E.append("text").attr("text-anchor","middle").attr("y",function(t){return z(+t.value)-8}).style("font-size",70*i.scale+"%").text(function(t){return 0!==t.value?t.value:"?"});d3.select(".nl.kippen text").attr("dy",-55).attr("dx",-10);var D=function(t){L.transition().duration(t).attr("x",function(t){return C(n[t.country])}).attr("transform",function(t){return"translate("+k[t.animal].x+", "+k[t.animal].y+")"}),N.transition().duration(t).attr("x",C("NL")-12).attr("transform","translate("+k.kippen.x+", "+k.kippen.y+")"),j.transition().duration(t).attr("x",function(t){return C(n[t.country])+l/2}).attr("transform",function(t){return"translate("+k[t.animal].x+", "+k[t.animal].y+")"}),A.transition().delay(.5*t).duration(.5*t).style("opacity",1),T.transition().duration(.5*t).style("opacity",0)},F=function(t){L.transition().duration(t).attr("x",function(t){return P(t.animal)}).attr("transform",function(t){return"translate("+R[t.country].x+", "+R[t.country].y+")"}),N.transition().duration(t).attr("x",P("kippen")-12).attr("transform","translate("+R.Nederland.x+", "+R.Nederland.y+")"),j.transition().duration(t).attr("x",function(t){return P(t.animal)+l/2}).attr("transform",function(t){return"translate("+R[t.country].x+", "+R[t.country].y+")"}),A.transition().duration(.5*t).style("opacity",0),T.transition().delay(.5*t).duration(.5*t).style("opacity",1)};F(0),D(3e3);var K="byAnimal";r=function(){"byCountry"===K?(D(3e3),K="byAnimal"):(F(3e3),K="byCountry")},e=d3.interval(r,6e3)})}var cachedInnerWidth;window.onload=function(){draw(),cachedInnerWidth=window.innerWidth},function(){window.addEventListener("resize",function(){var n=window.innerWidth;t||n===cachedInnerWidth||(t=setTimeout(function(){t=null,cachedInnerWidth=window.innerWidth,draw()},250))},!1);var t;window.addEventListener("orientationchange",function(){cachedInnerWidth=window.innerWidth,draw()})}();
//# sourceMappingURL=koeien-varkens-kippen.min.js.map
